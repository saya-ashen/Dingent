---
sidebar_position: 2
---

# 配置

我们使用 [**Pydantic-Settings**](https://docs.pydantic.dev/latest/concepts/pydantic_settings/) 来管理 Dingent 中的配置。这允许您以结构化的方式定义配置，支持环境变量、默认值和类型验证。但是，我们建议使用 TOML 文件来管理您的配置，这是我们模板中的默认方法。

对于像 `OPENAI_API_KEY` 这样的密钥，您可以将它们设置为环境变量或使用 `.env` 文件。

## 环境变量

Dingent 支持多个配置环境变量：

- `OPENAI_API_KEY`: 您的 OpenAI API 密钥（大多数 LLM 操作都需要）
- `OPENAI_BASE_URL`: 自定义 OpenAI API 基础 URL（可选）
- `LOG_LEVEL`: 日志级别（默认：INFO）

您可以在 shell 中设置这些变量，或在项目根目录中创建 `.env` 文件：

```bash
# .env 文件
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxx
LOG_LEVEL=DEBUG
```

## 插件配置

- **概念：工具 / 插件**

    在 Dingent 框架中，**工具** 或 **插件** 是系统可以执行的最小功能单元。您可以将其视为智能体可用的特定技能。例如：

  * 一个可以 **查看天气** 的工具。
  * 一个可以 **发送电子邮件** 的工具。
  * 一个可以 **执行数据库查询** 的工具。
  * 一个可以 **说你好** 的工具，就像我们之前的示例一样。

每个工具都由开发者创建，封装了与外部世界交互或执行特定计算的逻辑。作为用户，您的主要任务是在助手的配置中启用和配置这些工具，以满足您的特定需求。

- **如何配置工具？**

    您不需要为工具单独的配置文件。工具的配置直接在将使用它的 **助手** 内部定义。

    管理和使用插件的工作流程如下：

    -  **获取插件**: 由开发者编写或从社区下载，并放置在项目的 `assistants/plugins` 目录中。
    -  **查看可用插件**: 您可以使用命令行工具查看所有当前加载和可用的插件。
        ```bash
        dingent assistants plugin list
        ```
    -  **在助手中配置插件**: 在助手的配置文件中，填写您想要使用的插件的特定设置。您可以在下面的"助手"文档中看到详细的示例。

-----

## 助手配置

- **概念：助手**

    **助手是面向特定领域任务的工具集合**。

    如果"工具"是螺丝刀或扳手，那么"助手"就是为特定工作准备的完整 **工具箱**，比如"修理电脑"或"组装家具"。它不仅包含完成任务所需的工具，还包含如何执行任务的 **高级指令**。

    例如，您可以创建：

  * **通用聊天助手**: 配置有"问候"、"天气查询"、"网络搜索"等工具。
  * **数据分析助手**: 在其配置中直接集成一系列专业工具，如"数据库连接"和"SQL 执行"。
  * **客户服务助手**: 包括"订单查询"、"知识库检索"和"工单创建"等工具的配置。

    作为用户，您可以通过定义不同的助手来创建具有不同能力和个性的多个智能体。

- **如何配置助手？**

    您可以在单个 `TOML` 配置文件中定义一个或多个助手。每个助手的配置主要包括其基本信息（如名称）、行为指令，以及 **它被授权使用的工具及其详细配置**。

    我们建议使用 `.toml` 格式来管理您的助手配置，因为它能清晰地表示复杂的嵌套结构。

    **配置文件示例**

  * **文件位置**: `assistants/config.toml`

<!-- end list -->

```toml
# "[[assistants]]" 定义一个特定的助手实例。
# 您可以在同一个文件中定义多个 [[assistants]] 块。

[[assistants]]
name = "sakila"
host = "127.0.0.1"
port = "8888"
description = """
这个助手只能回答有关存储在数据库中的 DVD 租赁业务运营的问题。查询应该是关于分析业务绩效、客户行为或电影库存的。

使用此工具回答以下问题：
- 销售和收入：查找销售数据、商店或电影的总收入，以及特定付款的详细信息。
- 客户分析：询问客户租赁习惯，查找顶级客户，或分析客户人口统计数据（如他们的位置）。
- 电影和库存：按标题、类型（类别）或演员查找电影。检查特定商店中特定电影的库存水平。
- 商店和员工运营：探索有关各个商店、其员工和他们处理的租赁交易的信息。
"""

# "tools" 列表直接定义和配置此助手可用的工具。
tools = [
  {
    type = "text2sql",
    name = "sakila_text2sql",
    description = "将自然语言问题转换为 Sakila 数据库 SQL 查询的工具。",

    # --- text2sql 类型的特定配置 ---
    llm = { model="gpt-4.1", provider="openai" },
    database = {
      name = "sakila",
      uri = "sqlite:///./data/sakila.db",
      schemas_file = "schemas/sakila.py"
    }
  }
]

# [[assistants]]
# name = "another_assistant"
# ... 更多助手的配置 ...
```

- **配置字段说明**
      - `name`（必需）：您为此助手分配的唯一名称。
      * `host`（可选）：用于公开此助手服务的 IP 地址。
      * `port`（可选）：用于公开此助手服务的端口。
      * `description`（必需）：此助手功能的详细描述。此内容也作为大型语言模型的 **核心指令（系统提示）**。模型将严格遵循这些指令，这决定了它的个性、行为准则和任务目标。您可以使用 `"""` 进行多行文本。
      * `tools`（必需）：一个列表，**直接定义和配置** 此助手被授权使用的所有工具。
          * 这是一个配置对象列表，而不仅仅是 ID 列表。
          * 每个工具对象内的字段（例如，`type`、`name`、`llm`、`database`）由其插件类型决定。
          * 您需要查阅特定插件的 `README.md` 或相关文档，以了解其可配置参数以及如何填写它们。